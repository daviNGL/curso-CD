# TESTE DE HIPOTESE #




##### ======== AVALIANDO A NORMALIDADE DE UMA VARIAVEL ALEATORI ======= #####

#GERANDO VARIVEIS PARA O TESTE
```{r}

# GERA VARIAVEL ALEATORIA QUE SEGUE DIST. NORMAL, COM 70 OBSERVACOES, MEDIA 70 E DESV PADRAO 8
var_normal <- rnorm(n = 70, mean = 25, sd = 8)

# GERA VARIAVEL ALEATORIA F (NAO SEGUE DIST. NORMAL) COM 15 OBSERVACOES, 2 GRAUS DE LIBERDADE NO NUMERADOR E 10 NO DENOMINADOR 
var_n_normal <- rf(n = 15, df1 = 2, df2 = 10)

```



# VERIFICANDO SE A VARIAVEL SEGUE DISTRIBUICAO NORMAL
```{r}


# HISTOGRAMA (O FORMATO DA VAR N NORMAL EH BICAUDAL)
hist(x = var_normal)
hist(x = var_n_normal)


# QQPLOT (OS PONTOS DA VAR N NORMAL NAO SEGUEM A RETA)
qqnorm(y = var_normal)
qqline(y = var_normal)

qqnorm(y = var_n_normal)
qqline(y = var_n_normal)


# TESTE DE SHAPIRO-WILK (P-VALUE DA VAR N NORMAL < 5%, LOGO REJEITA H0=VAR NORMAL  )
shapiro.test(x = var_normal)
shapiro.test(x = var_n_normal)

```




## ==== TESTE T PARA DIFERENCA DE DUAS MEDIAS (VARIAVEIS INDEPENDENTES) === ##

# H0 : AS VENDAS DE UM PRODUTO NA POSICAO A, SAO IGUAIS NA POSICAO B.
# H1 : AS VENDAS SAO DIFERENTES NAS POSICOES A e B


```{r}

options(scipen = 666)

na <- 25
nb <- 30

media_a <- 150.1
media_b <- 182.1

sd_a <- 17
sd_b <- 19.2


vendas_a <- rnorm(n = na, mean = media_a, sd = sd_a)
vendas_b <- rnorm(n = nb, mean = media_b, sd = sd_b)


# CALCULA O T-VALOR
t.test(x = vendas_a,
       y = vendas_b,
       paired = FALSE,
       alternative = "two.sided",
       conf.level = 0.95)$p.value


#alternative = SE EH BICAUDAL OU UNICAUDAL
#LESS, two.sided, GREATER

```



## ==== TESTE T PARA DIFERENCA DE DUAS MEDIAS (VARIAVEIS DEPENDENTES) === ##

# H0 : O PESO MÉDIO APÓS A DIÉTA É IGUAL ANTES DA DIÉTA.
# H1 : O PESO MÉDIO APÓS A DIETA É MENOS QUE ANTES DA DIÉTA.

```{r}

# BIBLIOTECA PARA GERAR VALORES ALEATORIOS QUE SIGAM UM INTERVALO DE x A y

#install.packages("truncnorm")
library(truncnorm)

antes_dieta <- rtruncnorm(n = 20, a = 100, b = 140, mean = 123, sd = 18)
depois_dieta <- rtruncnorm(n = 20, a = 110, b = 130, mean = 110, sd = 28)


# PEGAR A DIFERENCA DE PESO DE CADA OBSERVACAO
diferenca <- antes_dieta - depois_dieta


# AVALIA A NORMALIDADE DA VARIAVEL COM AS DIFERENCAS
shapiro.test(x = diferenca)


# APLICA O TESTE T
t.test(x = depois_dieta, 
       y = antes_dieta, 
       paired = TRUE,
       alternative = "less",
       conf.level = 0.9)


#P VALOR MAIOR QUE ALFA, NAO PODEMOS REJEITAR H0, LOGO A DIETA NAO EH ESTATISTICAMENTE VALIDA#



```



## ==== TESTE QUIQUADRADO PRA ASSOCIACAO DE VARIAVEIS CATEGORICAS === ##

# H0 : O CLIENTE ESTAR ACOMPANHADO OU NAO DE CRIANCA, NAO INFLUENCIA SE VAI COMPRAR
# H1 : O CLIENTE ESTAR ACOMPANHADO OU NAO DE CRIANCA, INFLUENCIA SE VAI COMPRAR



```{r}

# DATA FRAME COM O CONJUNTO DE DADOS:

dados <- data.frame(
 
 Cliente = c("Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto", "Adulto", "Adulto", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto", "Adulto", "Adulto", "Adulto", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto", "Adulto_com_Crianca", "Adulto", "Adulto", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto_com_Crianca", "Adulto", "Adulto_com_Crianca", "Adulto", "Adulto", "Adulto", "Adulto","Adulto","Adulto","Adulto","Adulto","Adulto"),
 Comprou = c("Não_Comprou", "Não_Comprou", "Não_Comprou", "Não_Comprou", "Não_Comprou", "Não_Comprou", "Comprou", "Comprou", "Comprou", "Comprou", "Comprou", "Comprou", "Comprou", "Comprou", "Comprou", "Comprou", "Comprou", "Comprou", "Comprou", "Comprou", "Comprou", "Comprou", "Comprou", "Comprou", "Não_Comprou", "Não_Comprou", "Não_Comprou", "Não_Comprou", "Comprou", "Não_Comprou", "Comprou", "Comprou", "Não_Comprou", "Não_Comprou", "Não_Comprou", "Não_Comprou", "Não_Comprou", "Comprou", "Comprou", "Não_Comprou", "Não_Comprou", "Não_Comprou", "Não_Comprou", "Não_Comprou", "Comprou","Comprou","Comprou","Comprou","Comprou","Comprou")
 
)


dados$Cliente <- as.factor(dados$Cliente)
dados$Comprou <- as.factor(dados$Comprou)


# GERA A TABELA DE CONTINGENCIA
tabela <- table(dados$Cliente, dados$Comprou)

# APLICA O TESTE QUIQUADRADO
teste_qui <- chisq.test(x = tabela, correct = F)

teste_qui$observed
teste_qui$expected

teste_qui$p.value

#P-VALOR MUITO BAIXO, MESMO CON 99% DE NIVEL DE CONFIANCA AINDA PODERIA REJEITAR H0

```


